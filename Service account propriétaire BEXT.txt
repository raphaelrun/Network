Voici un script PowerShell que tu peux mettre dans une tâche planifiée pour remettre Raphael comme propriétaire du dossier TRUC et de tout son contenu :

# Script : Set-Owner-Raphael.ps1
# Définit "Raphael" comme propriétaire du dossier TRUC et de tout son contenu

$FolderPath = "C:\TRUC"
$Owner = "Raphael"

# S'assurer que le chemin existe
if (-not (Test-Path $FolderPath)) {
    Write-Output "Le dossier $FolderPath n'existe pas."
    exit 1
}

# Utilisation de takeown pour reprendre possession récursive
takeown /F $FolderPath /R /D Y | Out-Null

# Utilisation d'icacls pour réattribuer la propriété à Raphael
icacls $FolderPath /setowner $Owner /T /C

Write-Output "Le propriétaire du dossier $FolderPath et de son contenu est désormais $Owner."


Explications :

	takeown /F $FolderPath /R /D Y : force la prise de possession récursive.

	icacls $FolderPath /setowner Raphael /T /C : applique Raphael comme propriétaire partout (/T = récursif, /C = continue malgré erreurs).

	Ce script doit être exécuté avec des droits administrateur, sinon il échouera.

Mise en place en tâche planifiée :

	Sauvegarde ce script en C:\Scripts\Set-Owner-Raphael.ps1.

	Ouvre le Planificateur de tâches.

	Crée une nouvelle tâche, mets-la en exécution quotidienne.

	Dans Action → Démarrer un programme :

		Programme/script : powershell.exe

		Ajouter des arguments :
		-ExecutionPolicy Bypass -File "C:\Scripts\Set-Owner-Raphael.ps1"
